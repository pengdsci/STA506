---
title: "Assignment 6: Asymptotic Sampling Distribution of MLE"
author: "Your Name "
date: " Due: "
output:
  html_document: 
    toc: yes
    toc_depth: 4
    toc_float: yes
    number_sections: no
    toc_collapsed: yes
    code_folding: hide
    code_download: yes
    smooth_scroll: yes
    highlight: monochrome
    theme: spacelab
  pdf_document: 
    toc: yes
    toc_depth: 4
    fig_caption: yes
    number_sections: yes
    fig_width: 3
    fig_height: 3
  word_document: 
    toc: yes
    toc_depth: 4
    fig_caption: yes
    keep_md: yes
editor_options: 
  chunk_output_type: inline
---

```{css, echo = FALSE}
#TOC::before {
  content: "Table of Contents";
  font-weight: bold;
  font-size: 1.2em;
  display: block;
  color: navy;
  margin-bottom: 10px;
}


div#TOC li {     /* table of content  */
    list-style:upper-roman;
    background-image:none;
    background-repeat:none;
    background-position:0;
}

h1.title {    /* level 1 header of title  */
  font-size: 22px;
  font-weight: bold;
  color: DarkRed;
  text-align: center;
  font-family: "Gill Sans", sans-serif;
}

h4.author { /* Header 4 - and the author and data headers use this too  */
  font-size: 15px;
  font-weight: bold;
  font-family: system-ui;
  color: navy;
  text-align: center;
}

h4.date { /* Header 4 - and the author and data headers use this too  */
  font-size: 18px;
  font-weight: bold;
  font-family: "Gill Sans", sans-serif;
  color: DarkBlue;
  text-align: center;
}

h1 { /* Header 1 - and the author and data headers use this too  */
    font-size: 20px;
    font-weight: bold;
    font-family: "Times New Roman", Times, serif;
    color: darkred;
    text-align: center;
}

h2 { /* Header 2 - and the author and data headers use this too  */
    font-size: 18px;
    font-weight: bold;
    font-family: "Times New Roman", Times, serif;
    color: navy;
    text-align: left;
}

h3 { /* Header 3 - and the author and data headers use this too  */
    font-size: 16px;
    font-weight: bold;
    font-family: "Times New Roman", Times, serif;
    color: navy;
    text-align: left;
}

h4 { /* Header 4 - and the author and data headers use this too  */
    font-size: 14px;
  font-weight: bold;
    font-family: "Times New Roman", Times, serif;
    color: darkred;
    text-align: left;
}

/* Add dots after numbered headers */
.header-section-number::after {
  content: ".";

body { background-color:white; }

.highlightme { background-color:yellow; }

p { background-color:white; }

}
```

```{r setup, include=FALSE}
# code chunk specifies whether the R code, warnings, and output 
# will be included in the output files.
if (!require("knitr")) {
   install.packages("knitr")
   library(knitr)
}
if (!require("pander")) {
   install.packages("pander")
   library(pander)
}
if (!require("ggplot2")) {
  install.packages("ggplot2")
  library(ggplot2)
}
if (!require("tidyverse")) {
  install.packages("tidyverse")
  library(tidyverse)
}

if (!require("plotly")) {
  install.packages("plotly")
  library(plotly)
}
####
knitr::opts_chunk$set(echo = TRUE,       # include code chunk in the output file
                      warning = FALSE,   # sometimes, you code may produce warning messages,
                                         # you can choose to include the warning messages in
                                         # the output file. 
                      results = TRUE,    # you can also decide whether to include the output
                                         # in the output file.
                      message = FALSE,
                      comment = NA
                      )  
```
 
 \
 
## **Assignment Objectives** 

* Enhance understanding numerical methods in finding the MLE.

* Understand the procedure of deriving asymptotic sampling distribution of MLE.

* Implement asymptotic sampling distributions of MLE using various built-in R functions.

\

## **Policies of Using AI Tools**

**Policy on AI Tool Use**: Students must adhere to the AI tool policy specified in the course syllabus. The direct copying of AI-generated content is strictly prohibited. All submitted work must reflect your own understanding; where external tools are consulted, content must be thoroughly rephrased and synthesized in your own words.

**Code Inclusion Requirement**: Any code included in your essay must be properly commented to explain the purpose and/or expected output of key code lines. Submitting AI-generated code without meaningful, student-added comments will not be accepted.

\

**Log-normal Distribution**

The log-normal distributions have been widely used in many different fields such as finance and economics, engineering and reliability, environmental science, medical and biology etc. 


If $X$ follows a lognormal distribution:

$$
f(x; \mu, \sigma^2) = \frac{1}{x\sigma\sqrt{2\pi}} 
\exp\left[-\frac{(\ln x - \mu)^2}{2\sigma^2}\right], \quad x > 0
$$

where  $\mu \in \mathbb{R}$ is the mean of $\ln X$ and $\sigma^2 > 0$ is the variance of $\ln X$.

For an i.i.d. random sample $x_1, x_2, \dots, x_n$:

$$
\begin{align*}
\ell(\mu, \sigma^2) &= \sum_{i=1}^n \ln f(x_i; \mu, \sigma^2) \\
&= -\frac{n}{2} \ln(2\pi) - n \ln \sigma - \sum_{i=1}^n \ln x_i 
   - \frac{1}{2\sigma^2} \sum_{i=1}^n (\ln x_i - \mu)^2
\end{align*}
$$

\

<font color = "blue">This assignment focuses on finding the asymptotic sampling distributions of the MLE $\hat{\mu}$ and $\hat{\sigma^2}$ corresponding to $\mu$ and $\sigma^2$ based on an environmental study data.</font>


\

## **Question 1: Derive gradient function based on the log-likelihood function**

Assume that $\{x_1, x_2, \cdots, x_n \} \to \text{ LN }(\mu, \sigma^2)$ with density function given by

$$
\ell(\mu, \sigma^2) = -\frac{n}{2} \ln(2\pi) - n \ln \sigma - \sum_{i=1}^n \ln x_i 
   - \frac{1}{2\sigma^2} \sum_{i=1}^n (\ln x_i - \mu)^2
$$

Derive the score functions (gradient of the log-likelihood) for the log-normal distribution parameters. Start from the full log-likelihood and compute its partial derivatives with respect to $\mu$ and $\sigma^2$.


\

## **Question 2: Birth data set**

**Environmental Compliance**:  A factory must ensure waste water lead concentration < 5 mg/L (95th percentile).

```
1.2, 0.8, 2.1, 0.5, 3.2, 1.8, 0.9, 2.5, 1.1, 0.7, 2.8, 1.5,
1.3, 0.6, 2.9, 1.4, 0.9, 2.2, 1.7, 0.8, 3.1, 1.2, 0.5, 2.6
```
Assume the data follow a gamma distribution. Using these data and the specified algorithm, estimate the parameters $\mu$ and $\sigma^2$ as follows:

a) Compute the maximum likelihood estimates $\hat{\mu}$ and $\hat{\sigma}^2$ via gradient-based optimization in R using optim(), incorporating the gradient vector derived in Question 1.

b) Derive the method-of-moment estimators for $\mu$ and $\sigma^2$, denoted by $\tilde{\mu}$ and $\tilde{\sigma}^2$.

c) Plot three density curves on a single panel and compare their patterns. If modeling an environmental process like the one in this assignment, which density curve would you recommend? Justify your recommendation.





